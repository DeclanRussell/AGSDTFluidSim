\hypertarget{_cuda_s_p_h_kernals_8cu}{\section{cuda\-Src/\-Cuda\-S\-P\-H\-Kernals.cu File Reference}
\label{_cuda_s_p_h_kernals_8cu}\index{cuda\-Src/\-Cuda\-S\-P\-H\-Kernals.\-cu@{cuda\-Src/\-Cuda\-S\-P\-H\-Kernals.\-cu}}
}
{\ttfamily \#include $<$thrust/sort.\-h$>$}\\*
{\ttfamily \#include $<$thrust/fill.\-h$>$}\\*
{\ttfamily \#include $<$thrust/device\-\_\-ptr.\-h$>$}\\*
{\ttfamily \#include $<$thrust/scan.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Cuda\-S\-P\-H\-Kernals.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}helper\-\_\-math.\-h\char`\"{}}\\*
Include dependency graph for Cuda\-S\-P\-H\-Kernals.\-cu\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_cuda_s_p_h_kernals_8cu__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{_cuda_s_p_h_kernals_8cu_a1daf785e3f68d293c7caa1c756d5cb74}{\#define {\bfseries pi}~3.\-14159265359f}\label{_cuda_s_p_h_kernals_8cu_a1daf785e3f68d293c7caa1c756d5cb74}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\-\_\-\-\_\-global\-\_\-\-\_\- void \hyperlink{_cuda_s_p_h_kernals_8cu_afdcbd8ca539116cc7b8d030b1e418e77}{point\-Hash} (unsigned int $\ast$d\-\_\-hash\-Array, float3 $\ast$d\-\_\-pos\-Array, unsigned int num\-Particles, float resolution, float \-\_\-grid\-Scaler)
\begin{DoxyCompactList}\small\item\em Kernal designed to produce a has key based on the location of a particle. \end{DoxyCompactList}\item 
\-\_\-\-\_\-global\-\_\-\-\_\- void \hyperlink{_cuda_s_p_h_kernals_8cu_ad805b6eb0d36394de57c25b3d06718ca}{count\-Cell\-Occ\-Kernal} (unsigned int $\ast$d\-\_\-hash\-Array, unsigned int $\ast$d\-\_\-cell\-Occ\-Array, int \-\_\-hash\-Table\-Size, unsigned int \-\_\-num\-Points)
\begin{DoxyCompactList}\small\item\em This kernal is designed to count the cell occpancy of a hash table. \end{DoxyCompactList}\item 
\-\_\-\-\_\-device\-\_\-\-\_\- float \hyperlink{_cuda_s_p_h_kernals_8cu_aaaee82afeb737d25fb86efb6949aa1b5}{density\-Weighting} (float \-\_\-dst, float \-\_\-smoothing\-Length, float \-\_\-dens\-Kern\-Const)
\begin{DoxyCompactList}\small\item\em This is our desity weighting kernal used in our navier stokes equations. \end{DoxyCompactList}\item 
\-\_\-\-\_\-device\-\_\-\-\_\- float3 \hyperlink{_cuda_s_p_h_kernals_8cu_ad44155cc5df4e6c30367f437d6fcb489}{pressure\-Weighting} (float3 \-\_\-r, float \-\_\-dst, float \-\_\-smoothing\-Length, float \-\_\-press\-Kern\-Const)
\begin{DoxyCompactList}\small\item\em This is our desity weighting kernal used in our navier stokes equations. \end{DoxyCompactList}\item 
\-\_\-\-\_\-device\-\_\-\-\_\- float3 \hyperlink{_cuda_s_p_h_kernals_8cu_ad682f881cf72f537f3cad1ba7993b5b5}{viscosity\-Weighting} (float3 \-\_\-r, float \-\_\-dst, float \-\_\-smoothing\-Length, float \-\_\-visc\-Kern\-Const)
\begin{DoxyCompactList}\small\item\em This is our viscosty weighting kernal used in our navier stokes equations. \end{DoxyCompactList}\item 
\hypertarget{_cuda_s_p_h_kernals_8cu_a8e6781d18982655b4efd3db1e6548a41}{\-\_\-\-\_\-global\-\_\-\-\_\- void {\bfseries fluid\-Solver\-Per\-Cell\-Kernal} (int \-\_\-max\-Samples, float3 $\ast$d\-\_\-pos\-Array, float3 $\ast$d\-\_\-vel\-Array, unsigned int $\ast$d\-\_\-cell\-Occ\-Array, unsigned int $\ast$d\-\_\-cell\-Indx\-Array, int \-\_\-hash\-Resolution, int \-\_\-hash\-Table\-Size, float \-\_\-smoothing\-Length, float \-\_\-timestep, float \-\_\-particle\-Mass, float \-\_\-rest\-Density, float \-\_\-gas\-Constant, float \-\_\-vis\-Coef, float \-\_\-vel\-Correction, float dens\-Kern\-Const, float press\-Kern\-Const, float visc\-Kern\-Const)}\label{_cuda_s_p_h_kernals_8cu_a8e6781d18982655b4efd3db1e6548a41}

\item 
\hypertarget{_cuda_s_p_h_kernals_8cu_a560b747b87c9a6159b06cc73e719e144}{\-\_\-\-\_\-global\-\_\-\-\_\- void {\bfseries collision\-Det\-Kernal} (\hyperlink{struct_simple_cuboid_collision_object}{Simple\-Cuboid\-Collision\-Object} $\ast$d\-\_\-\-Collision\-Object\-Array, unsigned int \-\_\-num\-Objects, float3 $\ast$d\-\_\-pos\-Array, float3 $\ast$d\-\_\-vel\-Array, unsigned int \-\_\-num\-Particles, float \-\_\-time\-Step)}\label{_cuda_s_p_h_kernals_8cu_a560b747b87c9a6159b06cc73e719e144}

\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_afdcf7b761d59cb7dc7242693f8098380}{create\-Hash\-Table} (cuda\-Stream\-\_\-t \-\_\-stream, unsigned int $\ast$d\-\_\-hash\-Array, float3 $\ast$d\-\_\-pos\-Array, unsigned int \-\_\-num\-Particles, float \-\_\-smoothing\-Length, float \-\_\-grid\-Size, int \-\_\-max\-Num\-Threads)
\begin{DoxyCompactList}\small\item\em Creates a spatial hash key based on our particle postion. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a1541f8b1ee73799a0cecc7030773a6a9}{sort\-By\-Key} (unsigned int $\ast$d\-\_\-hash\-Array, float3 $\ast$d\-\_\-pos\-Array, float3 $\ast$d\-\_\-vel\-Array, unsigned int \-\_\-num\-Particles)
\begin{DoxyCompactList}\small\item\em Sorts our hash key buffer and postion buffer such that points of the same key occupy contiguous memory. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a5f674fd3497767724a4425bbb91a2248}{count\-Cell\-Occupancy} (cuda\-Stream\-\_\-t \-\_\-stream, unsigned int $\ast$d\-\_\-hash\-Array, unsigned int $\ast$d\-\_\-cell\-Occ\-Array, unsigned int \-\_\-hash\-Table\-Size, unsigned int \-\_\-num\-Points, unsigned int \-\_\-max\-Num\-Threads)
\begin{DoxyCompactList}\small\item\em Computes the particle occupancy of our hash cell. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a32490018a3312806721e0576ff6f8c7b}{fill\-Uint} (unsigned int $\ast$\-\_\-pointer, unsigned int \-\_\-array\-Size, unsigned int \-\_\-fill)
\begin{DoxyCompactList}\small\item\em simple function so that we can fill a buffer with unsigned ints. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a5ef63636297ac3ddbc0866064a75e12d}{create\-Cell\-Idx} (unsigned int $\ast$d\-\_\-cell\-Occ\-Array, unsigned int \-\_\-size, unsigned int $\ast$d\-\_\-cell\-Idx\-Array)
\begin{DoxyCompactList}\small\item\em Creates an index array for our cells using thrusts exclusive scan. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a59c1e6aa2f1fb9792cde8f2ab4eba1d5}{fluid\-Solver} (cuda\-Stream\-\_\-t \-\_\-stream, float3 $\ast$d\-\_\-pos\-Array, float3 $\ast$d\-\_\-vel\-Array, unsigned int $\ast$d\-\_\-cell\-Occ\-Array, unsigned int $\ast$d\-\_\-cell\-Indx\-Array, unsigned int \-\_\-hash\-Table\-Size, int \-\_\-hash\-Resolution, unsigned int \-\_\-max\-Num\-Threads, float \-\_\-smoothing\-Length, float \-\_\-timestep, float \-\_\-particle\-Mass, float \-\_\-rest\-Density, float \-\_\-gas\-Constant, float \-\_\-vis\-Coef, float \-\_\-vel\-Correction, float \-\_\-dens\-Kern\-Const, float \-\_\-press\-Kern\-Const, float \-\_\-visc\-Kern\-Const)
\begin{DoxyCompactList}\small\item\em Solver function that will call our solver kernal to calculate the new positions of the particles in. \end{DoxyCompactList}\item 
void \hyperlink{_cuda_s_p_h_kernals_8cu_a1985239f9afd133a3db010848f3950f6}{collision\-Detection\-Solver} (cuda\-Stream\-\_\-t \-\_\-stream, \hyperlink{struct_simple_cuboid_collision_object}{Simple\-Cuboid\-Collision\-Object} $\ast$d\-\_\-plane\-Array, unsigned int \-\_\-num\-Objects, float3 $\ast$d\-\_\-pos\-Array, float3 $\ast$d\-\_\-vel\-Array, float \-\_\-time\-Step, unsigned int \-\_\-num\-Particles, unsigned int \-\_\-max\-Num\-Threads)
\begin{DoxyCompactList}\small\item\em Collision detection between particles and planes. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Declan Russell 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
08/03/2015 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\-0 
\end{DoxyVersion}


\subsection{Function Documentation}
\hypertarget{_cuda_s_p_h_kernals_8cu_a1985239f9afd133a3db010848f3950f6}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!collision\-Detection\-Solver@{collision\-Detection\-Solver}}
\index{collision\-Detection\-Solver@{collision\-Detection\-Solver}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{collision\-Detection\-Solver}]{\setlength{\rightskip}{0pt plus 5cm}void collision\-Detection\-Solver (
\begin{DoxyParamCaption}
\item[{cuda\-Stream\-\_\-t}]{\-\_\-stream, }
\item[{{\bf Simple\-Cuboid\-Collision\-Object} $\ast$}]{d\-\_\-plane\-Array, }
\item[{unsigned int}]{\-\_\-num\-Objects, }
\item[{float3 $\ast$}]{d\-\_\-pos\-Array, }
\item[{float3 $\ast$}]{d\-\_\-vel\-Array, }
\item[{float}]{\-\_\-time\-Step, }
\item[{unsigned int}]{\-\_\-num\-Particles, }
\item[{unsigned int}]{\-\_\-max\-Num\-Threads}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a1985239f9afd133a3db010848f3950f6}


Collision detection between particles and planes. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-stream} & -\/ the cuda stream we wish this kernal to run on \\
\hline
{\em d\-\_\-\-Plane\-Array} & -\/ pointer to device buffer of our planes information \\
\hline
{\em \-\_\-num\-Planes} & -\/ number of planes in our array \\
\hline
{\em d\-\_\-pos\-Array} & -\/ pointer to device buffer of our particle positions \\
\hline
{\em d\-\_\-vel\-Array} & -\/ pointer to device buffer of our particle velocities \\
\hline
{\em \-\_\-time\-Step} & -\/ time step of our update \\
\hline
{\em \-\_\-num\-Particles} & -\/ the number of particles in our scene \\
\hline
{\em \-\_\-max\-Num\-Threads} & -\/ the maximum nuber of threads we need to launch per block \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{_cuda_s_p_h_kernals_8cu_a1985239f9afd133a3db010848f3950f6_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_ad805b6eb0d36394de57c25b3d06718ca}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!count\-Cell\-Occ\-Kernal@{count\-Cell\-Occ\-Kernal}}
\index{count\-Cell\-Occ\-Kernal@{count\-Cell\-Occ\-Kernal}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{count\-Cell\-Occ\-Kernal}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-global\-\_\-\-\_\- void count\-Cell\-Occ\-Kernal (
\begin{DoxyParamCaption}
\item[{unsigned int $\ast$}]{d\-\_\-hash\-Array, }
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Occ\-Array, }
\item[{int}]{\-\_\-hash\-Table\-Size, }
\item[{unsigned int}]{\-\_\-num\-Points}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_ad805b6eb0d36394de57c25b3d06718ca}


This kernal is designed to count the cell occpancy of a hash table. 


\begin{DoxyParams}{Parameters}
{\em d\-\_\-hash\-Array} & -\/ pointer to hash table buffer \\
\hline
{\em d\-\_\-cell\-Occ\-Array} & -\/ output array of cell occupancy count \\
\hline
{\em \-\_\-hash\-Table\-Size} & -\/ the size of our hash table \\
\hline
{\em \-\_\-num\-Points} & -\/ the number of particles in our hashed array \\
\hline
\end{DoxyParams}
\hypertarget{_cuda_s_p_h_kernals_8cu_a5f674fd3497767724a4425bbb91a2248}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!count\-Cell\-Occupancy@{count\-Cell\-Occupancy}}
\index{count\-Cell\-Occupancy@{count\-Cell\-Occupancy}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{count\-Cell\-Occupancy}]{\setlength{\rightskip}{0pt plus 5cm}void count\-Cell\-Occupancy (
\begin{DoxyParamCaption}
\item[{cuda\-Stream\-\_\-t}]{\-\_\-stream, }
\item[{unsigned int $\ast$}]{d\-\_\-hash\-Array, }
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Occ\-Array, }
\item[{unsigned int}]{\-\_\-hash\-Table\-Size, }
\item[{unsigned int}]{\-\_\-num\-Points, }
\item[{unsigned int}]{\-\_\-max\-Num\-Threads}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a5f674fd3497767724a4425bbb91a2248}


Computes the particle occupancy of our hash cell. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-stream} & -\/ the cuda stream we wish this kernal to run on \\
\hline
{\em d\-\_\-hash\-Array} & -\/ pointer to our hash key buffer \\
\hline
{\em d\-\_\-cell\-Occ\-Array} & -\/ pointer to our cell occupancy array \\
\hline
{\em \-\_\-hash\-Table\-Size} & -\/ size of our hash table \\
\hline
{\em \-\_\-num\-Points} & -\/ number of points in our hash table \\
\hline
{\em \-\_\-max\-Num\-Threads} & -\/ the maximum number of threads that we have per block on our device \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{_cuda_s_p_h_kernals_8cu_a5f674fd3497767724a4425bbb91a2248_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_a5ef63636297ac3ddbc0866064a75e12d}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!create\-Cell\-Idx@{create\-Cell\-Idx}}
\index{create\-Cell\-Idx@{create\-Cell\-Idx}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{create\-Cell\-Idx}]{\setlength{\rightskip}{0pt plus 5cm}void create\-Cell\-Idx (
\begin{DoxyParamCaption}
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Occ\-Array, }
\item[{unsigned int}]{\-\_\-size, }
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Idx\-Array}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a5ef63636297ac3ddbc0866064a75e12d}


Creates an index array for our cells using thrusts exclusive scan. 


\begin{DoxyParams}{Parameters}
{\em d\-\_\-cell\-Occ\-Array} & -\/ pointer to our hash table cell occupancy buffer on our device \\
\hline
{\em \-\_\-size} & -\/ the size of our buffer on our divice \\
\hline
{\em d\-\_\-cell\-Idx\-Array} & -\/ our output buffer on our device to store our index's \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{_cuda_s_p_h_kernals_8cu_a5ef63636297ac3ddbc0866064a75e12d_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_afdcf7b761d59cb7dc7242693f8098380}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!create\-Hash\-Table@{create\-Hash\-Table}}
\index{create\-Hash\-Table@{create\-Hash\-Table}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{create\-Hash\-Table}]{\setlength{\rightskip}{0pt plus 5cm}void create\-Hash\-Table (
\begin{DoxyParamCaption}
\item[{cuda\-Stream\-\_\-t}]{\-\_\-stream, }
\item[{unsigned int $\ast$}]{d\-\_\-hash\-Array, }
\item[{float3 $\ast$}]{d\-\_\-pos\-Array, }
\item[{unsigned int}]{\-\_\-num\-Particles, }
\item[{float}]{\-\_\-smoothing\-Length, }
\item[{float}]{\-\_\-grid\-Size, }
\item[{int}]{\-\_\-max\-Num\-Threads}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_afdcf7b761d59cb7dc7242693f8098380}


Creates a spatial hash key based on our particle postion. 

This is taken from Teschner, M., Heidelberger, B., Mueller, M., Pomeranets, D. and Gross, M. (2003). Optimized spatial hashing for collision detection of deformable objects 
\begin{DoxyParams}{Parameters}
{\em \-\_\-stream} & -\/ the cuda stream we wish this kernal to run on \\
\hline
{\em d\-\_\-hash\-Array} & -\/ a pointer to the cuda buffer that we wish to store our hash keys \\
\hline
{\em d\-\_\-pos\-Array} & -\/ pointer to the cuda buffer that holds the particle postions we wish to hash \\
\hline
{\em \-\_\-num\-Particles} & -\/ the number of particles. Used to calculate how many kernals to launch \\
\hline
{\em \-\_\-smoothing\-Length} & -\/ Smoothing length of our hash. How big each cell of our hash is. \\
\hline
{\em \-\_\-grid\-Size} & -\/ the size of our grid. .g. 1 is a grid of size 1$\ast$1$\ast$1. \\
\hline
{\em \-\_\-max\-Num\-Threads} & -\/ the maximum number off threads we have in a block on our device. Can be found out with device query \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{_cuda_s_p_h_kernals_8cu_afdcf7b761d59cb7dc7242693f8098380_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_aaaee82afeb737d25fb86efb6949aa1b5}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!density\-Weighting@{density\-Weighting}}
\index{density\-Weighting@{density\-Weighting}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{density\-Weighting}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-device\-\_\-\-\_\- float density\-Weighting (
\begin{DoxyParamCaption}
\item[{float}]{\-\_\-dst, }
\item[{float}]{\-\_\-smoothing\-Length, }
\item[{float}]{\-\_\-dens\-Kern\-Const}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_aaaee82afeb737d25fb86efb6949aa1b5}


This is our desity weighting kernal used in our navier stokes equations. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-dst} & -\/ the distance away of the neighbouring \\
\hline
{\em \-\_\-smoothing\-Length} & -\/ the smoothing length of our simulation. Can be thought of a hash cell size. \\
\hline
{\em \-\_\-dens\-Kern\-Cosnt} & -\/ constant part of our kernal. Easier to calculate once on C\-P\-U and have loaded into device kernal. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return the weighting that our neighbouring particle has on our current particle 
\end{DoxyReturn}
\hypertarget{_cuda_s_p_h_kernals_8cu_a32490018a3312806721e0576ff6f8c7b}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!fill\-Uint@{fill\-Uint}}
\index{fill\-Uint@{fill\-Uint}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{fill\-Uint}]{\setlength{\rightskip}{0pt plus 5cm}void fill\-Uint (
\begin{DoxyParamCaption}
\item[{unsigned int $\ast$}]{\-\_\-pointer, }
\item[{unsigned int}]{\-\_\-array\-Size, }
\item[{unsigned int}]{\-\_\-fill}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a32490018a3312806721e0576ff6f8c7b}


simple function so that we can fill a buffer with unsigned ints. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-pointer} & -\/ pointer to the buffer you wish to fill \\
\hline
{\em \-\_\-array\-Size} & -\/ size of the buffer you wish to fill \\
\hline
{\em \-\_\-fill} & -\/ what you wish to fill it with \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_cuda_s_p_h_kernals_8cu_a32490018a3312806721e0576ff6f8c7b_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_a59c1e6aa2f1fb9792cde8f2ab4eba1d5}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!fluid\-Solver@{fluid\-Solver}}
\index{fluid\-Solver@{fluid\-Solver}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{fluid\-Solver}]{\setlength{\rightskip}{0pt plus 5cm}void fluid\-Solver (
\begin{DoxyParamCaption}
\item[{cuda\-Stream\-\_\-t}]{\-\_\-stream, }
\item[{float3 $\ast$}]{d\-\_\-pos\-Array, }
\item[{float3 $\ast$}]{d\-\_\-vel\-Array, }
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Occ\-Array, }
\item[{unsigned int $\ast$}]{d\-\_\-cell\-Indx\-Array, }
\item[{unsigned int}]{\-\_\-hash\-Table\-Size, }
\item[{int}]{\-\_\-hash\-Resolution, }
\item[{unsigned int}]{\-\_\-max\-Num\-Threads, }
\item[{float}]{\-\_\-smoothing\-Length, }
\item[{float}]{\-\_\-timestep, }
\item[{float}]{\-\_\-particle\-Mass = {\ttfamily 1}, }
\item[{float}]{\-\_\-rest\-Density = {\ttfamily 1}, }
\item[{float}]{\-\_\-gas\-Constant = {\ttfamily 1}, }
\item[{float}]{\-\_\-vis\-Coef = {\ttfamily 1}, }
\item[{float}]{\-\_\-vel\-Correction = {\ttfamily 0.3}, }
\item[{float}]{\-\_\-dens\-Kern\-Const = {\ttfamily 1}, }
\item[{float}]{\-\_\-press\-Kern\-Const = {\ttfamily 1}, }
\item[{float}]{\-\_\-visc\-Kern\-Const = {\ttfamily 1}}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a59c1e6aa2f1fb9792cde8f2ab4eba1d5}


Solver function that will call our solver kernal to calculate the new positions of the particles in. 

our fluid simulation. 
\begin{DoxyParams}{Parameters}
{\em \-\_\-stream} & -\/ the cuda stream we wish this kernal to run on \\
\hline
{\em d\-\_\-pos\-Array} & -\/ pointer to our gpu buffer that holds the postions of our particles \\
\hline
{\em d\-\_\-vel\-Array} & -\/ pointer to our gpu buffer that holds the velocities of our particles \\
\hline
{\em d\-\_\-acc\-Array} & -\/ pointer to our gpu buffer that holds the accelleration of our particles \\
\hline
{\em d\-\_\-cell\-Occ\-Array} & -\/ pointer to our gpu buffer that holds the cell occupancy count of our hash table \\
\hline
{\em d\-\_\-cell\-Indx\-Array} & -\/ pointer to our gpu buffer that holds the cell index's of our particles \\
\hline
{\em \-\_\-hash\-Table\-Size} & -\/ the size of our hash table. This is used to calculate how many blocks we need to launch our kernal with \\
\hline
{\em \-\_\-max\-Num\-Threads} & -\/ the maximum nuber of threads we need to launch per block \\
\hline
{\em \-\_\-smoothing\-Length} & -\/ smoothing length of our simulation. Can also be thought of as cell size. \\
\hline
{\em \-\_\-time\-Step} & -\/ the timestep that we want to increment our particles positions in our solver \\
\hline
{\em \-\_\-particle\-Mass} & -\/ the mass of each particle. Defaults to 1. \\
\hline
{\em \-\_\-rest\-Density} & -\/ the density of each particle at rest. Defaults to 1. \\
\hline
{\em \-\_\-gas\-Constant} & -\/ the gas constant of our fluid. Used for calculating pressure. Defaults to 1. \\
\hline
{\em \-\_\-vis\-Coef} & -\/ the coeficient of viscosity in our fluid simulation. Defaults to 1. \\
\hline
{\em \-\_\-vel\-Correction} & -\/ velocity correction using our X\-S\-P\-H method. Helps with compression, defaults to 0.\-3. \\
\hline
{\em \-\_\-dens\-Kern\-Const} & -\/ constant part of the density kernal. Faster to compute once on C\-P\-U and load in. \\
\hline
{\em \-\_\-press\-Kern\-Const} & -\/ constant part of the pressure kernal. Faster to compute once on C\-P\-U and load in. \\
\hline
{\em \-\_\-visc\-Kern\-Const} & -\/ constant part of the viscosity kernal. Faster to compute once on C\-P\-U and load in. \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{_cuda_s_p_h_kernals_8cu_a59c1e6aa2f1fb9792cde8f2ab4eba1d5_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_afdcbd8ca539116cc7b8d030b1e418e77}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!point\-Hash@{point\-Hash}}
\index{point\-Hash@{point\-Hash}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{point\-Hash}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-global\-\_\-\-\_\- void point\-Hash (
\begin{DoxyParamCaption}
\item[{unsigned int $\ast$}]{d\-\_\-hash\-Array, }
\item[{float3 $\ast$}]{d\-\_\-pos\-Array, }
\item[{unsigned int}]{num\-Particles, }
\item[{float}]{resolution, }
\item[{float}]{\-\_\-grid\-Scaler}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_afdcbd8ca539116cc7b8d030b1e418e77}


Kernal designed to produce a has key based on the location of a particle. 

Hash function taken from Teschner, M., Heidelberger, B., Mueller, M., Pomeranets, D. and Gross, M. (2003). Optimized spatial hashing for collision detection of deformable objects 
\begin{DoxyParams}{Parameters}
{\em d\-\_\-hash\-Array} & -\/ pointer to a buffer to output our hash keys \\
\hline
{\em d\-\_\-pos\-Array} & -\/ pointer to the buffer that holds our particle positions \\
\hline
{\em num\-Particles} & -\/ the number of particles in our buffer \\
\hline
{\em resolution} & -\/ the resolution of our hash table \\
\hline
{\em \-\_\-grid\-Scaler} & -\/ Scales our points to between 0-\/1. \\
\hline
\end{DoxyParams}
\hypertarget{_cuda_s_p_h_kernals_8cu_ad44155cc5df4e6c30367f437d6fcb489}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!pressure\-Weighting@{pressure\-Weighting}}
\index{pressure\-Weighting@{pressure\-Weighting}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{pressure\-Weighting}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-device\-\_\-\-\_\- float3 pressure\-Weighting (
\begin{DoxyParamCaption}
\item[{float3}]{\-\_\-r, }
\item[{float}]{\-\_\-dst, }
\item[{float}]{\-\_\-smoothing\-Length, }
\item[{float}]{\-\_\-press\-Kern\-Const}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_ad44155cc5df4e6c30367f437d6fcb489}


This is our desity weighting kernal used in our navier stokes equations. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-r} & -\/ vector from our neighbour particle to our current particle between 0$<$x$<$=smoothing\-Length \\
\hline
{\em \-\_\-dst} & -\/ the distance between our particles \\
\hline
{\em \-\_\-smoothing\-Length} & -\/ the smoothing length of our simulation. Can be thought of a hash cell size. \\
\hline
{\em \-\_\-press\-Kern\-Cosnt} & -\/ constant part of our kernal. Easier to calculate once on C\-P\-U and have loaded into device kernal. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return the weighting that our neighbouring particle has on our current particle 
\end{DoxyReturn}
\hypertarget{_cuda_s_p_h_kernals_8cu_a1541f8b1ee73799a0cecc7030773a6a9}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!sort\-By\-Key@{sort\-By\-Key}}
\index{sort\-By\-Key@{sort\-By\-Key}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{sort\-By\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void sort\-By\-Key (
\begin{DoxyParamCaption}
\item[{unsigned int $\ast$}]{d\-\_\-hash\-Array, }
\item[{float3 $\ast$}]{d\-\_\-pos\-Array, }
\item[{float3 $\ast$}]{d\-\_\-vel\-Array, }
\item[{unsigned int}]{\-\_\-num\-Particles}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_a1541f8b1ee73799a0cecc7030773a6a9}


Sorts our hash key buffer and postion buffer such that points of the same key occupy contiguous memory. 


\begin{DoxyParams}{Parameters}
{\em d\-\_\-hash\-Array} & -\/ pointer to our hash key buffer \\
\hline
{\em d\-\_\-pos\-Array} & -\/ pointer to our particle position buffer \\
\hline
{\em d\-\_\-vel\-Array} & -\/ pointer to our particle velocity buffer \\
\hline
{\em d\-\_\-acc\-Array} & -\/ pointer to our particle acceleration buffer \\
\hline
{\em \-\_\-num\-Particles} & -\/ the number of particels in our buffer \\
\hline
\end{DoxyParams}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{_cuda_s_p_h_kernals_8cu_a1541f8b1ee73799a0cecc7030773a6a9_icgraph}
\end{center}
\end{figure}


\hypertarget{_cuda_s_p_h_kernals_8cu_ad682f881cf72f537f3cad1ba7993b5b5}{\index{Cuda\-S\-P\-H\-Kernals.\-cu@{Cuda\-S\-P\-H\-Kernals.\-cu}!viscosity\-Weighting@{viscosity\-Weighting}}
\index{viscosity\-Weighting@{viscosity\-Weighting}!CudaSPHKernals.cu@{Cuda\-S\-P\-H\-Kernals.\-cu}}
\subsubsection[{viscosity\-Weighting}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-device\-\_\-\-\_\- float3 viscosity\-Weighting (
\begin{DoxyParamCaption}
\item[{float3}]{\-\_\-r, }
\item[{float}]{\-\_\-dst, }
\item[{float}]{\-\_\-smoothing\-Length, }
\item[{float}]{\-\_\-visc\-Kern\-Const}
\end{DoxyParamCaption}
)}}\label{_cuda_s_p_h_kernals_8cu_ad682f881cf72f537f3cad1ba7993b5b5}


This is our viscosty weighting kernal used in our navier stokes equations. 


\begin{DoxyParams}{Parameters}
{\em \-\_\-r} & -\/ vector from our neighbour particle to our current particle \\
\hline
{\em \-\_\-dst} & -\/ the distance between our particles \\
\hline
{\em \-\_\-smoothing\-Length} & -\/ the smoothing length of our simulation. Can be thought of a hash cell size. \\
\hline
{\em \-\_\-visc\-Kern\-Cosnt} & -\/ constant part of our kernal. Easier to calculate once on C\-P\-U and have loaded into device kernal. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return the weighting that our neighbouring particle has on our current particle 
\end{DoxyReturn}
